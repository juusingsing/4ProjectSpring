<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"  
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="back.mapper.diary.DiaryMapper"> <!-- 매퍼의 네임스페이스 설정 -->
    
    <select id="getDiaryList" parameterType="back.model.diary.Diary" resultType="back.model.diary.Diary">
			SELECT
				A.DIARY_ID,
				A.DIARY_TITLE,
				A.DIARY_CONTENT,
				A.DIARY_DATE,
			    A.DIARY_TYPE,
			    A.CREATE_ID,
			    A.UPDATE_ID,
			    A.CREATE_DT,
			    A.UPDATE_DT,
			    A.DEL_YN
			FROM DIARY A
			<where>
			A.DEL_YN='N'
			<if test="diaryType != null and diaryType != ''">
   			 	AND A.DIARY_TYPE = #{diaryType}
			</if>
			</where>
			ORDER BY DIARY_DATE DESC

    </select>
    
    <select id="getDiaryById" parameterType="string" resultType="back.model.diary.Diary">
    	SELECT
    		DIARY_ID,
    		USERS_ID,
    		DIARY_TITLE,
    		DIARY_CONTENT,
    		DIARY_DATE,
    		DIARY_TYPE,
	        CREATE_ID,
	        UPDATE_ID,
	        CREATE_DT,
	        UPDATE_DT,
	       	DEL_YN
	   	FROM DIARY
	   	WHERE DIARY_ID = #{diaryId}
	   		AND DEL_YN='N'
    </select>
	<insert id="create" parameterType="back.model.diary.Diary">
        INSERT INTO DIARY 
	        (
	        DIARY_ID,
	        USERS_ID,
	        DIARY_TITLE,
	        DIARY_CONTENT,
	        DIARY_DATE,
	        DIARY_TYPE,
	        CREATE_ID,
	        CREATE_DT
	        )
	        VALUES 
	        (
	        DIARY_SEQ.NEXTVAL,
	        #{usersId}, 
	        #{diaryTitle}, 
	        #{diaryContent}, 
	        #{diaryDate},
	        #{diaryType},
	        #{createId},
	        SYSDATE
	        )
	    <selectKey keyProperty="diaryId" resultType="string" order="AFTER">
	       SELECT DIARY_SEQ.CURRVAL FROM DUAL
	    </selectKey>
     </insert>
    
     
    
	
</mapper>